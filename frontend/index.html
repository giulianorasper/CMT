<!doctype html>
<html class="no-js" lang="zxx">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>CMT</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- <link rel="manifest" href="site.webmanifest"> -->
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.png">
    <!-- Place favicon.ico in the root directory -->

    <!-- CSS here -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/themify-icons.css">
    <link rel="stylesheet" href="css/nice-select.css">
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/gijgo.css">
    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" href="css/slicknav.css">
    <link rel="stylesheet" href="css/style.css">



    <!-- <link rel="stylesheet" href="css/responsive.css"> -->




    <!--<link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">-->
    <!--<script src="//netdna.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>-->
    <!--<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>-->





</head>

<body >
    <!--[if lte IE 9]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
        <![endif]-->




    <!--slider_area_start-->
        <!--<div class="slider_area">-->
            <div class="dedicated_support support_bg">
            <!--<div class="bradcam_area">-->
                <div class="container">
                    <!--<div class="col-xl-9">-->
                        <!--<div class="slider_text text-center">-->
                         <!-- <img src="img/support/support_bg,,.png" alt="">  UNNECESSARY IMAGE IMPORT-->
                             <form id="test-form" class="white-popup-block">
                                <div class="popup_box ">
                                    <div class="popup_inner">
                                        <div class="logo text-center">
                                            <a href="#">
                                                <img src="img/vote-logo.png" style="width: 85px; height: 55px;" alt="">
                                            <!--deleted "font: bold;" in style-block, may re-add later-->
                                            </a>
                                        </div>
                                        <h3>Log in</h3>
                                        <!--<form action="home.html">-->
                                            <div class="row">
                                                <div class="col-xl-12 col-md-12">
                                                    <input type="text" placeholder="name" id="name" required>
                                                </div>
                                                <div class="col-xl-12 col-md-12">
                                                    <input type="password" placeholder="Password" id="password" required>
                                                     <span id='message'></span>
                                                </div>

                                                <div class="col-xl-12">
                                                    <button type="submit" class="boxed_btn_green">Log in</button>
                                                </div>
                                            </div>
                                        <!--</form>-->
                                    </div>
                                </div>
                            </form>
                </div>
            </div>


    <!-- JS here -->
    <script src="js/vendor/modernizr-3.5.0.min.js"></script>
    <script src="js/vendor/jquery-1.12.4.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/isotope.pkgd.min.js"></script>
    <script src="js/ajax-form.js"></script>
    <script src="js/waypoints.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <script src="js/imagesloaded.pkgd.min.js"></script>
    <script src="js/scrollIt.js"></script>
    <script src="js/jquery.scrollUp.min.js"></script>
    <script src="js/wow.min.js"></script>
    <script src="js/nice-select.min.js"></script>
    <script src="js/jquery.slicknav.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/gijgo.min.js"></script>

    <!--contact js-->
    <script src="js/contact.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/mail-script.js"></script>

    <script src="js/main.js"></script>


<script type="module">
    import LoginRequestPacket from "./communication/packets/LoginRequestPacket.js";
    import CommunicationManager from "./communication/CommunicationManager.js";
    import Cookies from "./communication/utils/Cookies.js";

            $("#test-form").submit(function (e) {
                //This prevents the default redirection due to form submission
                e.preventDefault();

                var name = document.getElementById("name").value;
                var password = document.getElementById("password").value;

                function success(packet) {
                    console.log("This method is called if a response from the server is received.");
                    // Take a look at the java docs for details on the structure of the packets.
                    if(packet.loginResponse === "Valid") {
                        Cookies.setCookie("token", packet.token, packet.expiration);
                        window.location.href = "./home.html";
                    } else {
                        $("#name").focus();
                        $('#message').html('Incorrect password').css('color', 'red');
                        return false;
                    }
                }

                function fail() {
                    console.log("This method is called if something went wrong during the general communication.");
                    $('#message').html('Backend communication failed').css('color', 'red');
                }

                const login = new LoginRequestPacket(name, password);

                // Send the request to the server
                CommunicationManager.send(login, success, fail);
            });

</script>



</body>

</html>